<body class="h-100 gradient-form" style="background-color: black;">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="card rounded-9 text-black">
        <div class="row">
          <div class="col-lg-12" style="background-color: rgb(84, 84, 84); padding: 20px;">
            <div class="text-center mb-5">
              <h2 class="mb-4">My Account</h2>
            </div>
            <div class="mb-4">
              <h4>Account Information</h4>
              <ul class="list-group">
                <li class="list-group-item">Username: {{userData.username}}</li>
                <li class="list-group-item">Email: {{userData.email}}</li>
              </ul>
            </div>

            <div class="mb-5">
              <h4>Workouts</h4>
              <table class="table table-dark table-striped">
                <thead>
                  <tr>
                    {{!-- add table headings here --}}
                  </tr>
                </thead>
                <tbody>
                  {{#each workouts}}
                  <tr>
                    {{!-- add workout data here --}}
                  </tr>
                  {{else}}
                  <tr>
                    <td colspan="4" class="text-center">No workouts. (－.－)...zzz</td>
                  </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>

            <!-- Mutual Friends Section -->
            <h4>Friends</h4>
            <div id="friends" class="mb-5">
              <ul class="list-group">
                {{#each friends}}
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="/profile?username={{this.username}}" class="text-decoration-none">{{this.username}}</a>
                    <button class="btn btn-danger btn-sm" data-username="{{this.username}}" data-action="remove">Remove</button>
                  </li>
                {{/each}}
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

<script>
  document.addEventListener("DOMContentLoaded", () =>{
     const friendsContainer = document.getElementById("friends");
     friendsContainer.addEventListener("click", async (event) => {
      const button = event.target;

      if (button.tagName === "BUTTON" && button.dataset.action) {
        const username = button.dataset.username;
        const action = button.dataset.action;

        try {
          const response = await fetch(`/friend-request/${action}`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ username }),
          });
          if (response.ok) {
            location.reload();
          } else {
            console.error(`Failed to ${action} friend`);
          }
        } catch (error) {
          console.error("Error removing friend:", error);
        }
      }
    });
  });
</script>
